<article id="<%= dom_id course %>" data-title="<%= course.title.downcase %>" data-search-target="courses" data-controller="modal-course" class=" rounded-lg border border-slate-400 p-4">
  <h2 class="font-bold text-xl mb-2">
    <%= course.title %>
  </h2>
  <p class="text-gray-700 mb-4 description"><%= course.description %></p>
  <%#
  <p class="text-gray-700 mb-4 h-20 overflow-y-auto"><%= course.short_description </p> %>
  <p class="text-gray-700 mb-4">Language: <%= course.language %></p>
  <p class="text-gray-700 mb-4">Level: <%= course.level %></p>
  <p class="text-gray-700 mb-4">Price: $ <%= course.price %></p>
  <p class="text-gray-700 mb-4">Lessons:  <%= course.lessons_count %></p>
  <p class="text-gray-700 mb-4">Rating:  <%= course.average_rating %> <%= display_star_rating(course.average_rating) %>  </p>
  <p class="text-gray-700 mb-4">Students:  <%= course.enrollments_count %> <%= icon("fa-solid fa-users fa-xs text-gray-600", "font-solid") %> </p>
  <% if review_button(course) %>
    <button class="rounded-lg py-1 px-3 mb-4 bg-blue-100 font-medium  hover:bg-blue">
      <%# <%= link_to "Edit your review", edit_enrollment_path(course.enrollments.where(user:current_user).first) %>
      <%=   review_button(course) %>
    </button>
    <%# <button class="rounded-lg py-1 px-3 mb-4 bg-blue-100 font-medium  hover:bg-blue">
      <%= link_to "See review", enrollment_path(course.enrollments.where(user:current_user).first)  %>
    <%# </button> %>
  <% end %>
  <section class="text-sm text-gray-600 mb-4">
    User: <%= course.user %>
  </section>
  <section class="flex flex-wrap gap-x-3 gap-y-3">
    <%# <%= button_to "Enroll", new_course_enrollment_path(course), class: "rounded-lg py-1 mb-2 px-3 bg-teal-200 font-medium mr-2 hover:bg-teal-300"  %>
    <button class="rounded-lg py-1 px-3 bg-lime-100 font-medium hover:bg-lime-300">
      <%= enrollment_button(course) %>
    </button>

    <% if purchased_course(current_user, course) %>
      <progress value="<%= course.progress(current_user) %>" max="100" class="w-full">
        <%= course.progress(current_user) %>%
      </progress>
    <% end %>

    <%= link_to "Show", course_path(course), class: "rounded-lg py-1 px-3 bg-gray-100 font-medium  hover:bg-gray-300" %>
    <% if policy(course).edit? %>
      <%= link_to raw("#{icon("fa-solid fa-pencil fa-xs", "font-solid")} Edit"), edit_course_path(course), data: { turbo_frame: "edit-modal" }, class: "rounded-lg py-1 px-3 bg-gray-100 font-medium hover:bg-gray-300" %>
    <% end %>
    <!-- <%= button_to raw("#{icon("fa-solid fa-trash fa-xs", "font-solid")} Destroy"), course_path(course.id), method: :delete, class: "rounded-lg py-1 mb-2 px-3 ml-3 bg-red-600 text-white font-medium hover:bg-red-700" %> -->
    <% if policy(course).destroy? %>
      <%= button_tag raw("#{icon("fa-solid fa-trash fa-xs", "font-solid")} Destroy"), type: "button", data: {
      action: 'click->modal-course#open',
      modal_url_value: course_path(course)
    }, class: "rounded-lg py-1  px-3  bg-red-500 text-white font-medium hover:bg-red-700" %>
    <% end %>
    <!-- modal -->
    <div data-modal-course-target="modalCourse" id="modalCourse" class="fixed inset-0 flex hidden items-center justify-center">
      <%= render 'shared/course_confirmation_modal' %>
    </div>
  </section>
</article>
